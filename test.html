<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è“ç»¿éƒ¨ç½²æ£€æµ‹å™¨ - æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        .test-section h2 {
            color: #667eea;
            margin-bottom: 15px;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            opacity: 0.9;
        }
        .status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        
        .api-endpoint {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }
        
        code {
            background: #f1f3f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Monaco', 'Consolas', monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”µ è“ç»¿éƒ¨ç½²æ£€æµ‹å™¨ - æµ‹è¯•é¡µé¢</h1>
        
        <div class="test-section">
            <h2>Cookie æ£€æµ‹æµ‹è¯•</h2>
            <p>æµ‹è¯•cookieæ£€æµ‹åŠŸèƒ½ï¼š</p>
            <button onclick="setCookie('environment', 'blue')">è®¾ç½® environment=blue</button>
            <button onclick="setCookie('env', 'staging')">è®¾ç½® env=staging</button>
            <button onclick="setCookie('deployment', 'test')">è®¾ç½® deployment=test</button>
            <button onclick="clearCookies()">æ¸…é™¤æ‰€æœ‰æµ‹è¯•Cookie</button>
            <div id="cookieStatus" class="status info">å½“å‰Cookie: <span id="currentCookies">æ— </span></div>
        </div>
        
        <div class="test-section">
            <h2>è¯·æ±‚æ£€æµ‹æµ‹è¯•</h2>
            <p>æµ‹è¯•è¯·æ±‚æ£€æµ‹åŠŸèƒ½ï¼Œæœ¬é¡µé¢æä¾›ä»¥ä¸‹APIç«¯ç‚¹ï¼š</p>
            
            <div class="api-endpoint">
                <strong>GET /api/env</strong><br>
                è¿”å›: <code>{"environment": "blue", "status": "active"}</code>
            </div>
            
            <div class="api-endpoint">
                <strong>GET /api/status</strong><br>
                è¿”å›: <code>{"deployment": "staging", "version": "1.0.0"}</code>
            </div>
            
            <div class="api-endpoint">
                <strong>GET /api/health</strong><br>
                è¿”å›: <code>{"status": "healthy", "env": "test"}</code>
            </div>
            
            <p>åœ¨æ’ä»¶è®¾ç½®ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é…ç½®è¿›è¡Œæµ‹è¯•ï¼š</p>
            <ul>
                <li>è¯·æ±‚è·¯å¾„: <code>/api/env</code>ï¼Œæ£€æµ‹å€¼: <code>blue</code></li>
                <li>è¯·æ±‚è·¯å¾„: <code>/api/status</code>ï¼Œæ£€æµ‹å€¼: <code>staging</code></li>
                <li>è¯·æ±‚è·¯å¾„: <code>/api/health</code>ï¼Œæ£€æµ‹å€¼: <code>test</code></li>
            </ul>
            
            <button onclick="testRequest('/api/env')">æµ‹è¯• /api/env</button>
            <button onclick="testRequest('/api/status')">æµ‹è¯• /api/status</button>
            <button onclick="testRequest('/api/health')">æµ‹è¯• /api/health</button>
            <div id="requestStatus" class="status info">ç‚¹å‡»æŒ‰é’®æµ‹è¯•APIè¯·æ±‚</div>
        </div>
        
        <div class="test-section">
            <h2>ä½¿ç”¨è¯´æ˜</h2>
            <ol>
                <li>å®‰è£…å¹¶å¯ç”¨æµè§ˆå™¨æ’ä»¶</li>
                <li>ç‚¹å‡»æ’ä»¶å›¾æ ‡æ‰“å¼€è®¾ç½®é¢æ¿</li>
                <li>é€‰æ‹©æ£€æµ‹æ¨¡å¼ï¼ˆCookieæ£€æµ‹ æˆ– è¯·æ±‚æ£€æµ‹ï¼‰</li>
                <li>é…ç½®ç›¸åº”çš„æ£€æµ‹å‚æ•°</li>
                <li>å¯ç”¨æ£€æµ‹å¹¶ä¿å­˜è®¾ç½®</li>
                <li>åœ¨æ­¤é¡µé¢æµ‹è¯•åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œ</li>
                <li>å½“æ£€æµ‹æ¡ä»¶åŒ¹é…æ—¶ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºæ°´å°æç¤º</li>
            </ol>
        </div>
    </div>

    <script>
        // Cookieæ“ä½œå‡½æ•°
        function setCookie(name, value) {
            document.cookie = `${name}=${value}; path=/`;
            updateCookieDisplay();
            document.getElementById('cookieStatus').className = 'status success';
            document.getElementById('cookieStatus').innerHTML = `å·²è®¾ç½® Cookie: ${name}=${value}`;
        }
        
        function clearCookies() {
            const cookies = ['environment', 'env', 'deployment'];
            cookies.forEach(name => {
                document.cookie = `${name}=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT`;
            });
            updateCookieDisplay();
            document.getElementById('cookieStatus').className = 'status info';
            document.getElementById('cookieStatus').innerHTML = 'å·²æ¸…é™¤æ‰€æœ‰æµ‹è¯•Cookie';
        }
        
        function updateCookieDisplay() {
            const cookies = document.cookie.split(';').filter(c => c.trim());
            const cookieDisplay = cookies.length > 0 ? cookies.join('; ') : 'æ— ';
            document.getElementById('currentCookies').textContent = cookieDisplay;
        }
        
        // è¯·æ±‚æµ‹è¯•å‡½æ•°
        async function testRequest(path) {
            const statusDiv = document.getElementById('requestStatus');
            statusDiv.className = 'status info';
            statusDiv.textContent = `æ­£åœ¨è¯·æ±‚ ${path}...`;
            
            try {
                const response = await fetch(path);
                const text = await response.text();
                statusDiv.className = 'status success';
                statusDiv.innerHTML = `<strong>${path}</strong> å“åº”: <code>${text}</code>`;
            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = `è¯·æ±‚å¤±è´¥: ${error.message}`;
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶æ›´æ–°Cookieæ˜¾ç¤º
        updateCookieDisplay();
    </script>
</body>
</html>